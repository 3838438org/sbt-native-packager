<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>My First Packaged Project &mdash; sbt-native-packager 0.7.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/yeti/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="sbt-native-packager 0.7.3 documentation" href="../index.html" />
    <link rel="up" title="Getting Started with Applications" href="index.html" />
    <link rel="next" title="Adding configuration" href="AddingConfiguration.html" />
    <link rel="prev" title="Getting Started with Applications" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          sbt-native-packager</a>
        <span class="navbar-text navbar-version pull-left"><b>0.7</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started with Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStartedServers/index.html">Getting Started with Servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DetailedTopics/index.html">Advanced Topics</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">My First Packaged Project</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: Getting Started with Applications"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Getting Started ...</span>
    </a>
  </li>
  <li>
    <a href="AddingConfiguration.html" title="Next Chapter: Adding configuration"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Adding configura... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/GettingStartedApplications/MyFirstProject.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="my-first-packaged-project">
<h1>My First Packaged Project<a class="headerlink" href="#my-first-packaged-project" title="Permalink to this headline">Â¶</a></h1>
<p>After installing the native packager, let&#8217;s set up a raw sbt project to experiment with bundling things.  First, let&#8217;s create a
<tt class="docutils literal"><span class="pre">project/build.properties</span></tt> file to save the sbt version</p>
<div class="highlight-python"><div class="highlight"><pre>sbt.version=0.13.1
</pre></div>
</div>
<p>sbt builds should always specify which version of sbt they are designed to use.  This helps keeps builds consistent between developers,
and documents to users which version of sbt you require for the build.</p>
<p>Next, let&#8217;s add the native packager to our build by created a <tt class="docutils literal"><span class="pre">project/plugins.sbt</span></tt> file with the following contents</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">addSbtPlugin</span><span class="p">(</span><span class="s">&quot;com.typesafe.sbt&quot;</span> <span class="o">%</span> <span class="s">&quot;sbt-native-packager&quot;</span> <span class="o">%</span> <span class="s">&quot;0.7.1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, the build needs to be configured for packaging.  Let&#8217;s define the <tt class="docutils literal"><span class="pre">build.sbt</span></tt> file as follows</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">com.typesafe.sbt.SbtNativePackager._</span>
<span class="k">import</span> <span class="nn">NativePackagerKeys._</span>

<span class="n">name</span> <span class="o">:=</span> <span class="s">&quot;example-cli&quot;</span>

<span class="n">version</span> <span class="o">:=</span> <span class="s">&quot;1.0&quot;</span>

<span class="n">packageArchetype</span><span class="o">.</span><span class="n">java_application</span>
</pre></div>
</div>
<p>The third line of <tt class="docutils literal"><span class="pre">build.sbt</span></tt> adds the default packaging settings for java applications. The native packager includes two
&#8220;batteries included&#8221; options for packaging applications:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">java_application</span></tt> - Defines packaging of your project with a start script and automatic PATH additions</li>
<li><tt class="docutils literal"><span class="pre">java_server</span></tt>      - Defines packaging of your project with automatic service start scripts (supports System V + init.d).</li>
</ul>
</div></blockquote>
<p>In addition to these, you can always directly configure all packaging by hand.   For now, we&#8217;re using one of the built-in options
as these are pretty robust and configurable.</p>
<p>Now that the build is set up, Let&#8217;s create an application that we can run on the command line.   Create the following file
<tt class="docutils literal"><span class="pre">src/main/scala/TestApp.scala</span></tt></p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">object</span> <span class="nc">TestApp</span> <span class="k">extends</span> <span class="nc">App</span> <span class="o">{</span>
  <span class="n">println</span><span class="o">(</span><span class="s">&quot;IT LIVES!&quot;</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Once this is created, start <tt class="docutils literal"><span class="pre">sbt</span></tt> on the console and run the <tt class="docutils literal"><span class="pre">stage</span></tt> command</p>
<div class="highlight-python"><div class="highlight"><pre>$ sbt
&gt; stage
</pre></div>
</div>
<p>Now, in another terminal, let&#8217;s look at what was generated</p>
<div class="highlight-python"><div class="highlight"><pre>target/universal/stage/
  bin/
    example-cli
    example-cli.bat
  lib/
    example-cli.example-cli-1.0.jar
    org.scala-lang.scala-library-2.10.3.jar
</pre></div>
</div>
<p>By default, the plugin has created both a windows BAT file and a linux/mac bash script for running the application.
In addition, all the dependent jars are added into the <tt class="docutils literal"><span class="pre">lib/</span></tt> folder.   Let&#8217;s try out the script in a terminal</p>
<div class="highlight-python"><div class="highlight"><pre>$ ./target/universal/stage/bin/example-cli
IT LIVES!
$
</pre></div>
</div>
<p>Now that the package has been verified, let&#8217;s work on the generic or &#8220;universal&#8221; packaging.   This is when
the plugin packages your application in a simple format that should be consumable from most operating systems or
platforms.  There are two ways to do this in the sbt console</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; universal:packageBin
[info] /home/jsuereth/projects/sbt/sbt-native-packager/tutorial-example/target/universal/example-cli-1.0.zip

&gt; universal:packageZipTarball
[info] /home/jsuereth/projects/sbt/sbt-native-packager/tutorial-example/target/universal/example-cli-1.0.tgz
</pre></div>
</div>
<p>This task simple constructs either a tgz or zip file with the exact same contents we found in the staged directory.</p>
<p>While this is a great first step towards deploying our application, we&#8217;d like to make it even simpler.  Our target
deployment platform is Ubuntu.  The command line tool should be usable by all our developers with a very simple
installation and update mechanism.   So, let&#8217;s try to make a debian out of our package.  Try the <tt class="docutils literal"><span class="pre">debian:packageBin</span></tt> task in the sbt console</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; debian:packageBin
[trace] Stack trace suppressed: run last debian:debianControlFile for the full output.
[error] (debian:debianControlFile) packageDescription in Debian cannot be empty. Use
[error]                  packageDescription in Debian := &quot;My package Description&quot;
[error] Total time: 0 s, completed Apr 1, 2014 10:21:13 AM
</pre></div>
</div>
<p>Here, the native packager is warning that we haven&#8217;t fully configured all the information required to genreate a valid debian file.  In particular, the packageDescription needs to be filled out for debian, in addition to a few other settings.   Let&#8217;s add the debian configuration to <tt class="docutils literal"><span class="pre">build.sbt</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre>name := &quot;example-cli&quot;

version := &quot;1.0&quot;

packageArchetype.java_application

packageDescription in Debian := &quot;Example Cli&quot;

maintainer in Debian := &quot;Josh Suereth&quot;
</pre></div>
</div>
<p>Now, let&#8217;s try to run the <tt class="docutils literal"><span class="pre">debian:packageBin</span></tt> command in the sbt console again</p>
<div class="highlight-python"><div class="highlight"><pre>$ sbt
&gt; debian:PacakgeBin
[info] Altering postrm/postinst files to add user example-cli and group example-cli
[info] dpkg-deb: building package `example-cli&#39; in `/home/jsuereth/projects/sbt/sbt-native-packager/tutorial-example/target/example-cli-1.0.deb&#39;
</pre></div>
</div>
<p>This generates a debian file that will install the following owners and files</p>
<div class="highlight-python"><div class="highlight"><pre>root:root                /usr/
examplecli:examplecli      share/example-cli/
examplecli:examplecli        bin/
examplecli:examplecli          example-cli
examplecli:examplecli        lib/
examplecli:examplecli          example-cli.example-cli-1.0.jar
examplecli:examplecli          org.scala-lang.scala-library-2.10.3.jar
root:root                  bin/
root:root                    example-cli -&gt; ../share/example-cli/bin/example-cli
</pre></div>
</div>
<p>So, the default packaing takes the &#8220;universal&#8221; distribution and places it inside a <tt class="docutils literal"><span class="pre">/usr/share</span></tt> directory, owned by a user for the application.   In addition, there is a a symlink in <tt class="docutils literal"><span class="pre">/usr/bin</span></tt> to the distributed bin script.  This allows users on the platform to run the <tt class="docutils literal"><span class="pre">example-cli</span></tt> as a native install.</p>
<p>We can generate other packages via the following tasks.  Here&#8217;s a complete list of current options.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">universal:packageBin</span></tt> - Generates a universal zip file</li>
<li><tt class="docutils literal"><span class="pre">universal:packageZipTarball</span></tt> - Generates a universal tgz file</li>
<li><tt class="docutils literal"><span class="pre">debian:packageBin</span></tt> - Generates a deb</li>
<li><tt class="docutils literal"><span class="pre">docker:publishLocal</span></tt> - Builds a Docker image using the local Docker server</li>
<li><tt class="docutils literal"><span class="pre">rpm:packageBin</span></tt> - Generates an rpm</li>
<li><tt class="docutils literal"><span class="pre">universal::packageOsxDmg</span></tt> - Generates a DMG file with the same contents as the universal zip/tgz.</li>
<li><tt class="docutils literal"><span class="pre">windows:packageBin</span></tt> - Generates an MSI</li>
</ul>
<p>While we only covered the necessary configuration for <tt class="docutils literal"><span class="pre">debian</span></tt>, each package type beyond <tt class="docutils literal"><span class="pre">universal</span></tt> requires some additonal
configuration relative to that packager.  For example, windows MSIs require UUIDs for all packages which are used to uniquely
identifiy two packages that may have the same name.</p>
<p>Next, let&#8217;s look at how to <a class="reference internal" href="AddingConfiguration.html"><em>Add configuration files</em></a> to use with our script.</p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014 sbt-native-packager team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>